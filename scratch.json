[
  {
    "type": "InitialState",
    "name": "Trigger",
    "properties": {
      "offset": {
        "x": -160,
        "y": -360
      },
      "flow_url": "https://webhooks.twilio.com/v1/Accounts/AC6563753c2be903701e0c9c6a80f9ef7e/Flows/FW1dd23b2cdeffbb35e8306e73c2434738"
    },
    "transitions": [
      {
        "event": "incomingMessage",
        "conditions": [],
        "next": "learn_more_q",
        "uuid": null
      },
      {
        "event": "incomingCall",
        "conditions": [],
        "next": null,
        "uuid": null
      },
      {
        "event": "incomingRequest",
        "conditions": [],
        "next": "learn_more_q",
        "uuid": null
      }
    ],
    "sid": "FF87a5ae3e82767f042b2be4874a8e8aeb"
  },
  {
    "sid": "FF6342636ac1016d6e52d83c78ec03a68a",
    "name": "learn_more_q",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -140,
        "y": -150
      },
      "body": "HI, I'm Alma, your personal florist. Would you like to learn more about me?"
    },
    "transitions": [
      {
        "widgetId": "FF6342636ac1016d6e52d83c78ec03a68a",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "learn_more_a"
      },
      {
        "widgetId": "FF6342636ac1016d6e52d83c78ec03a68a",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "learn_more_m"
      },
      {
        "widgetId": "FF6342636ac1016d6e52d83c78ec03a68a",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF02e73b1c8aadf402742562f6cc831378",
    "name": "learn_more_a",
    "type": "Function",
    "properties": {
      "offset": {
        "x": -470,
        "y": -150
      },
      "url": "https://crimson-bat-9748.twil.io/yes-no"
    },
    "transitions": [
      {
        "widgetId": "FF02e73b1c8aadf402742562f6cc831378",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "learn_more_yn"
      },
      {
        "widgetId": "FF02e73b1c8aadf402742562f6cc831378",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF2afa1136762614021ae47f1a1ea51738",
    "name": "learn_more_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 190,
        "y": -150
      },
      "body": "Sorry I seemed to have missed that. Would you like to learn more about me?"
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "learn_more_a"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF7cb4c1e4793ba5814203516ff239168c",
    "name": "learn_more_yn",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -210,
        "y": 90
      },
      "input": "{{widgets.learn_more_a.parsed.answer}}"
    },
    "transitions": [
      {
        "widgetId": "FF7cb4c1e4793ba5814203516ff239168c",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": "learn_more_m"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to yes",
            "value": "yes",
            "arguments": [
              "{{widgets.learn_more_a.parsed.answer}}"
            ]
          }
        ],
        "next": "about_flowers_q"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to no",
            "value": "no",
            "arguments": [
              "{{widgets.learn_more_a.parsed.answer}}"
            ]
          }
        ],
        "next": null
      }
    ]
  },
  {
    "sid": "FFc8555dc3379e317087d547a0d5764f13",
    "name": "about_flowers_q",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -150,
        "y": 330
      },
      "body": "[ Alma's story here ]\n\nWould you like to learn more about my flowers?"
    },
    "transitions": [
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "about_flowers_a"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "about_flowers_m"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF1f0fb178b6d58fedf1bed2d0b456bf53",
    "name": "about_flowers_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 180,
        "y": 330
      },
      "body": "Sorry I seemed to have missed that. Would you like to learn more about my flowers?"
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "about_flowers_a"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF58d6c6c53b5b6206588685931b937203",
    "name": "about_flowers_a",
    "type": "Function",
    "properties": {
      "offset": {
        "x": -480,
        "y": 330
      },
      "url": "https://crimson-bat-9748.twil.io/yes-no"
    },
    "transitions": [
      {
        "widgetId": "FF02e73b1c8aadf402742562f6cc831378",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "about_flowers_yn"
      },
      {
        "widgetId": "FF02e73b1c8aadf402742562f6cc831378",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF1fffeeddf2694c25f8cd52cbe9aa20dd",
    "name": "about_flowers_yn",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -230,
        "y": 580
      },
      "input": "{{widgets.about_flowers_a.parsed.answer}}"
    },
    "transitions": [
      {
        "widgetId": "FF7cb4c1e4793ba5814203516ff239168c",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": null
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to yes",
            "value": "yes",
            "arguments": [
              "{{widgets.about_flowers_a.parsed.answer}}"
            ]
          }
        ],
        "next": "order_flowers_q"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to no",
            "value": "no",
            "arguments": [
              "{{widgets.about_flowers_a.parsed.answer}}"
            ]
          }
        ],
        "next": "order_flowers_q2"
      }
    ]
  },
  {
    "sid": "FF38160e9a5ff9df4de638a3baa17b3bb8",
    "name": "order_flowers_q",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -340,
        "y": 820
      },
      "body": "[ About Alma's flowers ]\n\nWould you like to order some flowers?"
    },
    "transitions": [
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "order_flowers_a"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "order_flowers_m"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF45965c0e06ed6f3a689b6cc7ec1c3272",
    "name": "order_flowers_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 310,
        "y": 820
      },
      "body": "Sorry I seemed to have missed that. Would you like to order some flowers?"
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "order_flowers_a"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF302c489a8a24abcaf20f290db9005587",
    "name": "order_flowers_a",
    "type": "Function",
    "properties": {
      "offset": {
        "x": -660,
        "y": 820
      },
      "url": "https://crimson-bat-9748.twil.io/yes-no"
    },
    "transitions": [
      {
        "widgetId": "FF02e73b1c8aadf402742562f6cc831378",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "order_flowers_yn"
      },
      {
        "widgetId": "FF02e73b1c8aadf402742562f6cc831378",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FFc8bbc9b600f13df69888386d3edc0e05",
    "name": "order_flowers_yn",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -400,
        "y": 1060
      },
      "input": "{{widgets.order_flowers_a.parsed.answer}}"
    },
    "transitions": [
      {
        "widgetId": "FF7cb4c1e4793ba5814203516ff239168c",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": "order_flowers_m"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to yes",
            "value": "yes",
            "arguments": [
              "{{widgets.order_flowers_a.parsed.answer}}"
            ]
          }
        ],
        "next": "card_on_file_bool"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to no",
            "value": "no",
            "arguments": [
              "{{widgets.order_flowers_a.parsed.answer}}"
            ]
          }
        ],
        "next": null
      }
    ]
  },
  {
    "sid": "FF884b7f10fdb45c09406e44c248c9ff89",
    "name": "card_on_file_bool",
    "type": "Function",
    "properties": {
      "offset": {
        "x": 60,
        "y": 1060
      },
      "url": "https://crimson-bat-9748.twil.io/cardOnFile",
      "parameters": [
        {
          "key": "number",
          "value": "{{trigger.message.From}}"
        }
      ]
    },
    "transitions": [
      {
        "widgetId": "FF884b7f10fdb45c09406e44c248c9ff89",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "card_on_file"
      },
      {
        "widgetId": "FF884b7f10fdb45c09406e44c248c9ff89",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF0a56f14c367bc610ff53bd84f8330bb4",
    "name": "order_flowers_q2",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -20,
        "y": 820
      },
      "body": "Would you like to order some flowers?"
    },
    "transitions": [
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "order_flowers_yn"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "order_flowers_m"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF68e8b6283e2236c8c808d1316aa650e8",
    "name": "card_on_file",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -220,
        "y": 1310
      },
      "input": "{{widgets.card_on_file_bool.parsed.cardOnFile}}"
    },
    "transitions": [
      {
        "widgetId": "FF68e8b6283e2236c8c808d1316aa650e8",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": null
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to true",
            "value": "true",
            "arguments": [
              "{{widgets.card_on_file_bool.parsed.cardOnFile}}"
            ]
          }
        ],
        "next": "for_you_q"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to false",
            "value": "false",
            "arguments": [
              "{{widgets.card_on_file_bool.parsed.cardOnFile}}"
            ]
          }
        ],
        "next": "send_billing_form"
      }
    ]
  },
  {
    "sid": "FF31ff69ff3161362171bceb76080202b1",
    "name": "for_you_q",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -150,
        "y": 1530
      },
      "body": "Are these flowers for you?"
    },
    "transitions": [
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "for_you_a"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "for_you_m"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF1d98ca4ac6c1e1a86d6b9310c42c2d60",
    "name": "send_billing_form",
    "type": "Message",
    "properties": {
      "from": "{{flow.channel.address}}",
      "to": "{{contact.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "offset": {
        "x": 250,
        "y": 1310
      },
      "body": "It loooks like we don't have any billing info on file for you. Please follow the link below to add it and I'll wait here!\n\nhttp://order.countrygreenery.florist/R4J7"
    },
    "transitions": [
      {
        "widgetId": "FF1d98ca4ac6c1e1a86d6b9310c42c2d60",
        "uuid": null,
        "event": "sent",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF1d98ca4ac6c1e1a86d6b9310c42c2d60",
        "uuid": null,
        "event": "failed",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF40ab8bf6535e3fe6fe6637c4a3a591b9",
    "name": "for_you_yn",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -220,
        "y": 1750
      },
      "input": "{{widgets.for_you_a.parsed.answer}}"
    },
    "transitions": [
      {
        "widgetId": "FF7cb4c1e4793ba5814203516ff239168c",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": null
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to yes",
            "value": "yes",
            "arguments": [
              "{{widgets.for_you_a.parsed.answer}}"
            ]
          }
        ],
        "next": "suggestion_q"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to no",
            "value": "no",
            "arguments": [
              "{{widgets.for_you_a.parsed.answer}}"
            ]
          }
        ],
        "next": "recipient_num_a"
      }
    ]
  },
  {
    "sid": "FFc584086e8587193d1f3046d9a3233b68",
    "name": "for_you_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 170,
        "y": 1530
      },
      "body": "Sorry I seemed to have missed that. Are these flowers for you? Please answer yes or no."
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "for_you_a"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF7f104e9f1923fe7b752a5dffa4a41b4a",
    "name": "for_you_a",
    "type": "Function",
    "properties": {
      "offset": {
        "x": -490,
        "y": 1530
      },
      "url": "https://crimson-bat-9748.twil.io/yes-no"
    },
    "transitions": [
      {
        "widgetId": "FF02e73b1c8aadf402742562f6cc831378",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "for_you_yn"
      },
      {
        "widgetId": "FF02e73b1c8aadf402742562f6cc831378",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FFd53da1c3bcca865a597a3b18eed8dc3c",
    "name": "recipient_num_a",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -450,
        "y": 1980
      },
      "body": "What is your recipients 10-digit mobile number?"
    },
    "transitions": [
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "check_recipient_number"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF0253da35761283e5badf62a859293e7e",
    "name": "check_recipient_number",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -110,
        "y": 1980
      },
      "input": "{{widgets.recipient_num_a.inbound.Body}}"
    },
    "transitions": [
      {
        "widgetId": "FF0253da35761283e5badf62a859293e7e",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": "check_recipient_num_m"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "regex",
            "friendly_name": "If value regex ^\\s*(?:\\+?(\\d{1,3}))?[-. (]*(\\d{3})[-. )]*(\\d{3})[-. ]*(\\d{4})(?: *x(\\d+))?\\s*$",
            "value": "^\\s*(?:\\+?(\\d{1,3}))?[-. (]*(\\d{3})[-. )]*(\\d{3})[-. ]*(\\d{4})(?: *x(\\d+))?\\s*$",
            "arguments": [
              "{{widgets.recipient_num_a.inbound.Body}}"
            ]
          }
        ],
        "next": "save_recipient_num"
      }
    ]
  },
  {
    "sid": "FFcefad00607eba4553d996753acabf125",
    "name": "check_recipient_num_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 520,
        "y": 1980
      },
      "body": "Sorry I seemed to have missed that. Please give me a 10 digit US phone number for your recipient."
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "recipient_num_a"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF20a5eb6fd355f12a964e57718d2d4a3e",
    "name": "save_recipient_num",
    "type": "Function",
    "properties": {
      "offset": {
        "x": 30,
        "y": 2230
      },
      "url": "https://crimson-bat-9748.twil.io/save-field",
      "parameters": [
        {
          "key": "field",
          "value": "{{widgets.check_recipient_number.Choice}}"
        }
      ]
    },
    "transitions": [
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "recipient_name_a"
      },
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FFbf67f7fe1598da2ebd451f8b2c8ad935",
    "name": "recipient_name_a",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -440,
        "y": 2240
      },
      "body": "Okay great. What is your recipients first and last name?"
    },
    "transitions": [
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "recipient_name"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "recipient_name_m"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF4c9c96084269604cd027a77c589de50a",
    "name": "recipient_name",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -160,
        "y": 2460
      },
      "input": "{{widgets.recipient_name_a.inbound.Body}}"
    },
    "transitions": [
      {
        "widgetId": "FF0253da35761283e5badf62a859293e7e",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": "recipient_name_m"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "regex",
            "friendly_name": "If value regex ^\\s*(?:\\+?(\\d{1,3}))?[-. (]*(\\d{3})[-. )]*(\\d{3})[-. ]*(\\d{4})(?: *x(\\d+))?\\s*$",
            "value": "^[a-z ,.'-]+$",
            "arguments": [
              "{{widgets.recipient_name_a.inbound.Body}}"
            ]
          }
        ],
        "next": "save_recipient_name"
      }
    ]
  },
  {
    "sid": "FF5701431b17e0eb3f0517aa87844772bc",
    "name": "recipient_name_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 480,
        "y": 2450
      },
      "body": "Sorry I seemed to have missed that. Please tell me your recipients first and last name, e.g. \"John Smith\"."
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "recipient_name_a"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FFe39234acdb7596d1d1bde48dc8aebaa5",
    "name": "save_recipient_name",
    "type": "Function",
    "properties": {
      "offset": {
        "x": 10,
        "y": 2700
      },
      "url": "https://crimson-bat-9748.twil.io/save-field",
      "parameters": [
        {
          "key": "field",
          "value": "{{widgets.check_recipient_name.Choice}}",
          "index": 0
        }
      ]
    },
    "transitions": [
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "recipient_relationship_a"
      },
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF5cf1f92e500c7a1cdc7b8b11163faec0",
    "name": "recipient_relationship_a",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -360,
        "y": 2700
      },
      "body": "Got it, thansks. \n\nWhat is your relationship to the recipient."
    },
    "transitions": [
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "recipient_relationship"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "recipient_relationship_m"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF0501658e39a5c038c8ee5768e78f2442",
    "name": "recipient_relationship",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -20,
        "y": 2920
      },
      "input": "{{widgets.recipient_relationship_a.inbound.Body}}"
    },
    "transitions": [
      {
        "widgetId": "FF0501658e39a5c038c8ee5768e78f2442",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": "recipient_relationship_m"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "is_not_blank",
            "friendly_name": "If value equal_to [a-z]",
            "value": "Is Not Blank",
            "arguments": [
              "{{widgets.recipient_relationship_a.inbound.Body}}"
            ]
          }
        ],
        "next": "save_recipient_relationship"
      }
    ]
  },
  {
    "sid": "FF789cd022d21ac2ad0c624277a47d35a6",
    "name": "recipient_relationship_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 350,
        "y": 2920
      },
      "body": "Sorry I seemed to have missed that. Please tell me your relationship to the recipient. You can say something like mother, brother, or friend."
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "recipient_relationship_a"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF2227f633751f9b0e2a7f20a2b09f4f4f",
    "name": "save_recipient_relationship",
    "type": "Function",
    "properties": {
      "offset": {
        "x": 0,
        "y": 3160
      },
      "url": "https://crimson-bat-9748.twil.io/save-field",
      "parameters": [
        {
          "key": "field",
          "value": "{{widgets.recipient_occasion.Choice}}",
          "index": 0
        }
      ]
    },
    "transitions": [
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "recipient_occasion_a"
      },
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FFaa734182a37cae64114590717028d05a",
    "name": "recipient_occasion_a",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -360,
        "y": 3160
      },
      "body": "Okay thanks – and what occasion are the flowers for?"
    },
    "transitions": [
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "recipient_occasion"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "recipient_occasion_m"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FFdc4cfa9a5af789d639a5a7d3d0e16965",
    "name": "recipient_occasion",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -10,
        "y": 3400
      },
      "input": "{{widgets.recipient_occasion_a.inbound.Body}}"
    },
    "transitions": [
      {
        "widgetId": "FFdc4cfa9a5af789d639a5a7d3d0e16965",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": "recipient_occasion_m"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "is_not_blank",
            "value": "Is Not Blank",
            "arguments": [
              "{{widgets.recipient_occasion_a.inbound.Body}}"
            ]
          }
        ],
        "next": "save_occasion"
      }
    ]
  },
  {
    "sid": "FFc110de0f89853a0c17f1db5966ef8e5b",
    "name": "recipient_occasion_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 360,
        "y": 3400
      },
      "body": "Sorry I seemed to have missed that. Please tell me what occasion you're sending flowers for. You can say something like a birthday, wedding, or get well."
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "recipient_occasion_a"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF5fc5dae0acfe02c8c642843d983e1ddd",
    "name": "save_occasion",
    "type": "Function",
    "properties": {
      "offset": {
        "x": 0,
        "y": 3650
      },
      "url": "https://crimson-bat-9748.twil.io/save-field",
      "parameters": [
        {
          "key": "field",
          "value": "{{widgets.recipient_occasion.Choice}}"
        }
      ]
    },
    "transitions": [
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "time_q"
      },
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF83e11e3755d1932c6a2f8ace20b48af8",
    "name": "time_q",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -720,
        "y": 3920
      },
      "body": "Got it! And do you want the flowers to arrive before noon?"
    },
    "transitions": [
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "time_yn"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "time_m"
      },
      {
        "widgetId": "FFc8555dc3379e317087d547a0d5764f13",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FFc43dd81655859d3cae1c061418493967",
    "name": "time_yn",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": -60,
        "y": 3910
      },
      "input": "{{widgets.for_you_a.parsed.answer}}"
    },
    "transitions": [
      {
        "widgetId": "FF7cb4c1e4793ba5814203516ff239168c",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": "time_m"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to yes",
            "value": "yes",
            "arguments": [
              "{{widgets.for_you_a.parsed.answer}}"
            ]
          }
        ],
        "next": "save_time"
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to no",
            "value": "no",
            "arguments": [
              "{{widgets.for_you_a.parsed.answer}}"
            ]
          }
        ],
        "next": null
      }
    ]
  },
  {
    "sid": "FFd2bf11911be36fdc10f05f16a866b588",
    "name": "time_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 430,
        "y": 3910
      },
      "body": "Sorry I seemed to have missed that. Did you want the flowers to arrive before noon? You can say Yes or No."
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "time_q"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF13a719af539091e7c1d96616649ae3e7",
    "name": "save_time",
    "type": "Function",
    "properties": {
      "offset": {
        "x": 30,
        "y": 4170
      },
      "url": "https://crimson-bat-9748.twil.io/save-field",
      "parameters": [
        {
          "key": "field",
          "value": "{{widgets.time_yn.Choice}}",
          "index": 0
        }
      ]
    },
    "transitions": [
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "suggestion_q"
      },
      {
        "widgetId": "FF20a5eb6fd355f12a964e57718d2d4a3e",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF0fec536f769682f4837e553ebd8c2e0c",
    "name": "suggestion_q",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": -700,
        "y": 4390
      },
      "body": "Here are the flowers I recommend for you based on your answers. Does this work?"
    },
    "transitions": [
      {
        "widgetId": "FF0fec536f769682f4837e553ebd8c2e0c",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "suggestion_a"
      },
      {
        "widgetId": "FF0fec536f769682f4837e553ebd8c2e0c",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": "suggestion_m"
      },
      {
        "widgetId": "FF0fec536f769682f4837e553ebd8c2e0c",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF29d344925b75d6f390ef32d3edf06fd9",
    "name": "suggestion_m",
    "type": "MessagePrompt",
    "properties": {
      "from": "{{flow.channel.address}}",
      "channel": "{{trigger.message.ChannelSid}}",
      "service": "{{trigger.message.InstanceSid}}",
      "timeout": 3600,
      "offset": {
        "x": 470,
        "y": 4390
      },
      "body": "Sorry I seemed to have missed that. Do the above flowers work for you? You can say Yes or No..."
    },
    "transitions": [
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "incomingMessage",
        "conditions": [],
        "next": "suggestion_q"
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "timeout",
        "conditions": [],
        "next": null
      },
      {
        "widgetId": "FF2afa1136762614021ae47f1a1ea51738",
        "uuid": null,
        "event": "deliveryFailure",
        "conditions": [],
        "next": null
      }
    ]
  },
  {
    "sid": "FF79bf383c0cf812758503f0e0f11e02ee",
    "name": "suggestion_yn",
    "type": "Branch",
    "properties": {
      "offset": {
        "x": 0,
        "y": 4390
      },
      "input": "{{widgets.for_you_a.parsed.answer}}"
    },
    "transitions": [
      {
        "widgetId": "FF7cb4c1e4793ba5814203516ff239168c",
        "uuid": null,
        "event": "noMatch",
        "conditions": [],
        "next": null
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to yes",
            "value": "yes",
            "arguments": [
              "{{widgets.for_you_a.parsed.answer}}"
            ]
          }
        ],
        "next": null
      },
      {
        "uuid": null,
        "event": "match",
        "conditions": [
          {
            "type": "equal_to",
            "friendly_name": "If value equal_to no",
            "value": "no",
            "arguments": [
              "{{widgets.for_you_a.parsed.answer}}"
            ]
          }
        ],
        "next": null
      }
    ]
  },
  {
    "sid": "FF987dffe87557a7c366ae113a7c47850d",
    "name": "suggestion_a",
    "type": "Function",
    "properties": {
      "offset": {
        "x": -350,
        "y": 4390
      },
      "url": "https://crimson-bat-9748.twil.io/yes-no",
      "parameters": [
        {
          "key": "field",
          "value": "{{widgets.suggestion_q.inbound.Body}}"
        }
      ]
    },
    "transitions": [
      {
        "widgetId": "FF483ac69f918ed4edf35869ff25090f83",
        "uuid": null,
        "event": "success",
        "conditions": [],
        "next": "suggestion_yn"
      },
      {
        "widgetId": "FF483ac69f918ed4edf35869ff25090f83",
        "uuid": null,
        "event": "fail",
        "conditions": [],
        "next": null
      }
    ]
  }
]